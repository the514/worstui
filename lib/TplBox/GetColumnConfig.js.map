{"version":3,"sources":["../../src/TplBox/GetColumnConfig.js"],"names":["confirm","GetColumnConfig","k","v","object","thisClass","regExp","textIndex","search","thisObject","message","required","slice","valuePropName","getValueFromEvent","initialValue","render","text","record","paddingRight","onCellClick","event","config","getHeader","target","getAttribute","LoadingStart","get","getUrl","props","modelUrl","id","then","response","headers","setTokenHeader","setState","showData","data","LoadingEnd","showVisible","editVisible","setTimeout","scrollTop","dataId","catch","error","openNotification","type","title","body","console","log","getAuth","editData","onOk","delete","updateList","deleteTips","onCancel"],"mappings":";;;;;;AAAA;;;;AAEA;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,UAAU,YAAMA,OAAtB;;AAEA;AACA,IAAMC,kBAAkB,SAAlBA,eAAkB,CAASC,CAAT,EAAYC,CAAZ,EAAeC,MAAf,EAAuBC,SAAvB,EAAiC;AAAE;;AAEzD,MAAIC,SAAS,cAAb;AACA,MAAIC,YAAYL,EAAEM,MAAF,CAASF,MAAT,CAAhB;AACA,MAAIG,aAAaL,MAAjB;;AAEA,MAAIK,WAAWC,OAAf,EAAwB;AACtBD,eAAWE,QAAX,GAAsB,IAAtB;AACD;;AAED,UAAOJ,YAAU,CAAC,CAAX,GAAaL,EAAEU,KAAF,CAAQL,SAAR,CAAb,GAAgCL,CAAvC;;AAEE,SAAK,MAAL;AACEO,iBAAWI,aAAX,GAA2B,UAA3B;AACAJ,iBAAWK,iBAAX,GAA+B,IAA/B;AACA;AACF,SAAK,SAAL;AACEL,iBAAWI,aAAX,GAA2B,UAA3B;AACAJ,iBAAWK,iBAAX,GAA+B,IAA/B;AACA;AACF,SAAK,WAAL;AACEL,iBAAWI,aAAX,GAA0B,SAA1B;AACAJ,iBAAWM,YAAX,GAAyB,KAAzB;AACA;AACF,SAAK,UAAL;AACEN,iBAAWI,aAAX,GAA0B,SAA1B;AACAJ,iBAAWM,YAAX,GAAyB,KAAzB;AACA;AACF,SAAK,SAAL;AACEN,iBAAWO,MAAX,GAAoB,UAACC,IAAD,EAAOC,MAAP;AAAA,eACN;AAAA;AAAA;AACE;AAAA;AAAA,cAAG,eAAY,MAAf;AACE,wDAAM,MAAK,QAAX,EAAoB,eAAY,MAAhC,EAAuC,OAAO,EAACC,cAAc,KAAf,EAA9C,GADF;AAAA;AAAA,WADF;AAKE,kDAAM,WAAU,aAAhB,GALF;AAME;AAAA;AAAA,cAAG,eAAY,MAAf;AACE,wDAAM,MAAK,MAAX,EAAkB,eAAY,MAA9B,EAAqC,OAAO,EAACA,cAAc,KAAf,EAA5C,GADF;AAAA;AAAA,WANF;AAUE,kDAAM,WAAU,aAAhB,GAVF;AAWE;AAAA;AAAA,cAAG,eAAY,QAAf;AACE,wDAAM,MAAK,QAAX,EAAoB,eAAY,QAAhC,EAAyC,OAAO,EAACA,cAAc,KAAf,EAAhD,GADF;AAAA;AAAA;AAXF,SADM;AAAA,OAApB;AAkBAV,iBAAWW,WAAX,GAAyB,UAACF,MAAD,EAASG,KAAT,EAAmB;AAC1C;AACA;AACA,YAAMC,SAAS,iBAAOC,SAAP,EAAf;;AAEA,YAAIF,MAAMG,MAAN,CAAaC,YAAb,CAA0B,aAA1B,MAA6C,MAAjD,EAAyD;;AAEvD,2BAAOC,YAAP;;AAGA,0BAAMC,GAAN,CAAU,iBAAOC,MAAP,KAAkBvB,UAAUwB,KAAV,CAAgBC,QAAlC,GAA6C,GAA7C,GAAmDZ,OAAOa,EAApE,EAAwET,MAAxE,EACGU,IADH,CACQ,oBAAY;;AAEhB,gBAAIC,SAASC,OAAT,CAAiB,cAAjB,CAAJ,EAAsC;AACpC,+BAAOC,cAAP,CAAsBF,QAAtB;AACD;AACD;AACA;AACA5B,sBAAU+B,QAAV,CAAmB,EAAEC,UAAUJ,SAASK,IAArB,EAAnB;AACA,6BAAOC,UAAP;;AAEAlC,sBAAU+B,QAAV,CAAmB,EAAEI,aAAa,IAAf,EAAnB;AACAnC,sBAAU+B,QAAV,CAAmB,EAAEK,aAAa,KAAf,EAAnB;;AAEAC,uBAAY,YAAU;AACpB,oCAAE,+BAAF,EAAmCC,SAAnC,CAA6C,CAA7C;AACD,aAFD,EAEI,GAFJ;;AAIAtC,sBAAU+B,QAAV,CAAmB,EAAEQ,QAAQX,SAASK,IAAT,CAAcP,EAAxB,EAAnB;AACD,WAnBH,EAoBGc,KApBH,CAoBS,UAAUC,KAAV,EAAiB;AACtB,6BAAOC,gBAAP,CAAwB,EAACC,MAAK,OAAN,EAAeC,OAAM,MAArB,EAA6BC,MAAK,aAAlC,EAAxB;AACAC,oBAAQC,GAAR,CAAYN,KAAZ;AACA,6BAAOO,OAAP,CAAeP,KAAf;AACA,6BAAOP,UAAP;AACD,WAzBH;AA0BD,SA/BD,MA+BM,IAAIlB,MAAMG,MAAN,CAAaC,YAAb,CAA0B,aAA1B,MAA6C,MAAjD,EAAyD;;AAE7D,2BAAOC,YAAP;;AAEA,0BAAMC,GAAN,CAAU,iBAAOC,MAAP,KAAkBvB,UAAUwB,KAAV,CAAgBC,QAAlC,GAA6C,GAA7C,GAAmDZ,OAAOa,EAApE,EAAwET,MAAxE,EACGU,IADH,CACQ,oBAAY;AAChB,gBAAIC,SAASC,OAAT,CAAiB,cAAjB,CAAJ,EAAsC;AACpC,+BAAOC,cAAP,CAAsBF,QAAtB;AACD;AACD;AACA5B,sBAAU+B,QAAV,CAAmB,EAAEkB,UAAUrB,SAASK,IAArB,EAAnB;AACA;;AAEA,6BAAOC,UAAP;;AAEAlC,sBAAU+B,QAAV,CAAmB,EAAEI,aAAa,KAAf,EAAnB;AACAnC,sBAAU+B,QAAV,CAAmB,EAAEK,aAAa,IAAf,EAAnB;;AAEAC,uBAAY,YAAU;AACpB,oCAAE,+BAAF,EAAmCC,SAAnC,CAA6C,CAA7C;AACD,aAFD,EAEI,GAFJ;;AAIA;AACA;;AAEAtC,sBAAU+B,QAAV,CAAmB,EAAEQ,QAAQX,SAASK,IAAT,CAAcP,EAAxB,EAAnB;AACD,WAtBH,EAuBGc,KAvBH,CAuBS,UAAUC,KAAV,EAAiB;AACtB,6BAAOC,gBAAP,CAAwB,EAACC,MAAK,OAAN,EAAeC,OAAM,MAArB,EAA6BC,MAAK,aAAlC,EAAxB;AACAC,oBAAQC,GAAR,CAAYN,KAAZ;AACA,6BAAOO,OAAP,CAAeP,KAAf;AACA,6BAAOP,UAAP;AACD,WA5BH;AA6BD,SAjCK,MAiCA,IAAIlB,MAAMG,MAAN,CAAaC,YAAb,CAA0B,aAA1B,MAA6C,QAAjD,EAA2D;;AAE/DzB,kBAAQ;AACNiD,mBAAO,OADD;AAEN;AACAM,gBAHM,kBAGC;AACL;AACA,+BAAO7B,YAAP;;AAEA,8BAAM8B,MAAN,CAAa,iBAAO5B,MAAP,KAAkBvB,UAAUwB,KAAV,CAAgBC,QAAlC,GAA6C,GAA7C,GAAmDZ,OAAOa,EAAvE,EAA2ET,MAA3E,EACGU,IADH,CACQ,oBAAY;AAChB,oBAAIC,SAASC,OAAT,CAAiB,cAAjB,CAAJ,EAAsC;AACpC,mCAAOC,cAAP,CAAsBF,QAAtB;AACD;AACD;AACA5B,0BAAUoD,UAAV;AACA,iCAAOV,gBAAP,CAAwB,EAACC,MAAK,SAAN,EAAiBC,OAAM,MAAvB,EAA+BC,MAAK7C,UAAUwB,KAAV,CAAgB6B,UAApD,EAAxB;AACA,iCAAOnB,UAAP;AAED,eAVH,EAWGM,KAXH,CAWS,UAAUC,KAAV,EAAiB;AACtB,iCAAOC,gBAAP,CAAwB,EAACC,MAAK,OAAN,EAAeC,OAAM,MAArB,EAA6BC,MAAK,aAAlC,EAAxB;AACAC,wBAAQC,GAAR,CAAYN,KAAZ;AACA,iCAAOO,OAAP,CAAeP,KAAf;AACA,iCAAOP,UAAP;AACD,eAhBH;AAiBD,aAxBK;AAyBNoB,oBAzBM,sBAyBK;AACT;AACD;AA3BK,WAAR;AA8BD;AACF,OAtGD;;AAwGA;AACF;;AA9IF;AAiJA;AACA,SAAOlD,UAAP;AAED,CA9JD;;kBAgKeR,e","file":"GetColumnConfig.js","sourcesContent":["import React from 'react';\n\nimport { Icon, Modal } from 'antd';\nimport Global from '../Global';\nimport axios from 'axios';\nimport $ from 'jquery';\n\nconst confirm = Modal.confirm;\n\n// 字段样式\nconst GetColumnConfig = function(k, v, object, thisClass){ // k:字段名, object 当前字段配置对象, thisClass List对象\n\n  let regExp = /(_){1}[^_]+$/;\n  let textIndex = k.search(regExp);\n  let thisObject = object;\n\n  if (thisObject.message) {\n    thisObject.required = true;\n  }\n\n  switch(textIndex>-1?k.slice(textIndex):k){\n\n    case \"_img\":\n      thisObject.valuePropName = 'fileList';\n      thisObject.getValueFromEvent = true;\n      break;\n    case \"_imgarr\":\n      thisObject.valuePropName = 'fileList';\n      thisObject.getValueFromEvent = true;\n      break;\n    case \"_checkbox\":\n      thisObject.valuePropName= \"checked\";\n      thisObject.initialValue= false;\n      break;\n    case \"_boolean\":\n      thisObject.valuePropName= \"checked\";\n      thisObject.initialValue= false;\n      break;\n    case \"_action\":\n      thisObject.render = (text, record) => (\n                    <span>\n                      <a data-button=\"show\">\n                        <Icon type=\"search\" data-button=\"show\" style={{paddingRight: \"5px\"}} /> \n                        查看\n                      </a>\n                      <span className=\"ant-divider\" />\n                      <a data-button=\"edit\">\n                        <Icon type=\"edit\" data-button=\"edit\" style={{paddingRight: \"5px\"}} /> \n                        编辑\n                      </a>\n                      <span className=\"ant-divider\" />\n                      <a data-button=\"delete\">\n                        <Icon type=\"delete\" data-button=\"delete\" style={{paddingRight: \"5px\"}} />\n                        删除\n                      </a>\n                    </span>\n                  );\n      thisObject.onCellClick = (record, event) => {\n        // console.log(record);\n        // console.log(event);\n        const config = Global.getHeader();\n\n        if (event.target.getAttribute(\"data-button\") === \"show\") {\n\n          Global.LoadingStart();\n\n\n          axios.get(Global.getUrl() + thisClass.props.modelUrl + \"/\" + record.id, config)\n            .then(response => {\n\n              if (response.headers[\"access-token\"]) {\n                Global.setTokenHeader(response);\n              }\n              // console.log(response.headers);\n              // console.log(response);\n              thisClass.setState({ showData: response.data });\n              Global.LoadingEnd();\n              \n              thisClass.setState({ showVisible: true });\n              thisClass.setState({ editVisible: false });\n\n              setTimeout((function(){\n                $(\".showModel .ant-modal-content\").scrollTop(0);\n              }), 200);\n\n              thisClass.setState({ dataId: response.data.id });\n            })\n            .catch(function (error) {\n              Global.openNotification({type:\"error\", title:\"操作失败\", body:\"请求超时，请刷新重试！\"});\n              console.log(error);\n              Global.getAuth(error);\n              Global.LoadingEnd();\n            });\n        }else if (event.target.getAttribute(\"data-button\") === \"edit\") {\n\n          Global.LoadingStart();\n\n          axios.get(Global.getUrl() + thisClass.props.modelUrl + \"/\" + record.id, config)\n            .then(response => {\n              if (response.headers[\"access-token\"]) {\n                Global.setTokenHeader(response);\n              }\n              // console.log(response);\n              thisClass.setState({ editData: response.data });\n              // console.log( response.data.id );\n\n              Global.LoadingEnd();\n              \n              thisClass.setState({ showVisible: false });\n              thisClass.setState({ editVisible: true });\n\n              setTimeout((function(){\n                $(\".editModel .ant-modal-content\").scrollTop(0);\n              }), 200);\n\n              // console.log(response.data);\n              // console.log(response.data.id);\n\n              thisClass.setState({ dataId: response.data.id });\n            })\n            .catch(function (error) {\n              Global.openNotification({type:\"error\", title:\"操作失败\", body:\"请求超时，请刷新重试！\"});\n              console.log(error);\n              Global.getAuth(error);\n              Global.LoadingEnd();\n            });\n        }else if (event.target.getAttribute(\"data-button\") === \"delete\") {\n\n          confirm({\n            title: '确定删除?',\n            // content: 'Some descriptions',\n            onOk() {\n              // console.log('OK');\n              Global.LoadingStart();\n\n              axios.delete(Global.getUrl() + thisClass.props.modelUrl + \"/\" + record.id, config)\n                .then(response => {\n                  if (response.headers[\"access-token\"]) {\n                    Global.setTokenHeader(response);\n                  }\n                  // console.log(response.headers);\n                  thisClass.updateList();\n                  Global.openNotification({type:\"success\", title:\"操作成功\", body:thisClass.props.deleteTips});\n                  Global.LoadingEnd();\n                  \n                })\n                .catch(function (error) {\n                  Global.openNotification({type:\"error\", title:\"操作失败\", body:\"请求超时，请刷新重试！\"});\n                  console.log(error);\n                  Global.getAuth(error);\n                  Global.LoadingEnd();\n                });\n            },\n            onCancel() {\n              // console.log('Cancel');\n            },\n          });\n\n        }\n      }\n\n      break;\n    default:\n\n  }\n  // console.log(thisObject);\n  return thisObject;\n\n}\n\nexport default GetColumnConfig;"]}