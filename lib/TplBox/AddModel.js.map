{"version":3,"sources":["../../src/TplBox/AddModel.js"],"names":["FormItem","Item","CollectionCreateForm","create","props","visible","onCancel","onCreate","form","getFieldDecorator","formItemLayout","labelCol","span","wrapperCol","formItems","each","formItemList","index","val","columns","addHidden","rulesObj","initObj","dataType","undefined","type","required","message","rules","initialValue","valuePropName","getValueFromEvent","normFile","push","title","formItemName","newKey","width","height","overflow","top","AddModel","state","model","modelName","showModal","setState","handleCancel","handleCreate","e","validateFields","err","fieldsValue","console","log","jsonRequestType","k","v","regExp","textIndex","search","slice","tagIndex","tagVal","format","LoadingStart","config","getHeader","params","post","url","modelUrl","then","response","headers","setTokenHeader","openNotification","body","addTips","updateList","LoadingEnd","catch","error","getAuth","resetFields","saveFormRef","dataValue","dataTpl","modelNameArr","projectUrl","i","key","isLocal"],"mappings":"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","file":"AddModel.js","sourcesContent":["import React, { Component } from 'react';\nimport Global from '../Global';\nimport Config from '../Modules/Config';\nimport GetColumnTpl from './GetColumnTpl';\nimport { Modal, Button, Form } from 'antd';\nimport axios from 'axios';\nimport $ from 'jquery';\n\nconst FormItem = Form.Item;\n\nconst CollectionCreateForm = Form.create({\n  // onValuesChange: (props, values) => {\n  //   console.log(props);\n  //   console.log(values);\n  //   $.each(values, function(k, v) {\n  //     $.each(values[k], function(key, val) {\n  //       console.log(key);\n  //       Global.linkageChangeData(key);\n  //     });\n  //   });\n  // }\n})(\n  (props) => {\n\n    const { visible, onCancel, onCreate, form } = props;\n    const { getFieldDecorator } = form;\n\n    const formItemLayout = {\n      labelCol: { span: 3 },\n      wrapperCol: { span: 18 },\n    };\n\n    var formItems = [];\n    $.each(props.formItemList, function(index, val) {\n      if(props.columns[index].addHidden !== true){  // 是否在添加表单显示\n\n        let rulesObj = {}; // 配置字段验证\n        let initObj = {}; // 配置字段默认设置\n\n        if(props.columns[index].dataType!==undefined){\n\n          rulesObj =  {\n            type: props.columns[index].dataType,\n            required: props.columns[index].required?true:false, \n            message: props.columns[index].message?props.columns[index].message:\"\"\n          };\n\n          initObj.rules = [rulesObj];\n\n        }else{\n\n          rulesObj = {\n            required: props.columns[index].required?true:false, \n            message: props.columns[index].message?props.columns[index].message:\"\" \n          };\n\n          initObj.rules = [rulesObj]; // 合并配置字段验证初始化设置\n\n        }\n        \n        if (props.columns[index].initialValue!==undefined) {\n          initObj.initialValue = props.columns[index].initialValue;\n        }else{\n          initObj.initialValue = null;\n        }\n\n        if (props.columns[index].valuePropName!==undefined) {\n          initObj.valuePropName = props.columns[index].valuePropName;\n        }\n\n        if (props.columns[index].getValueFromEvent!==undefined) {\n          initObj.getValueFromEvent = props.normFile;\n        }\n\n        formItems.push(\n          <FormItem\n            {...formItemLayout}\n            label={props.columns[index].title} \n            key={index}\n          >\n\n            {getFieldDecorator(props.formItemName[index], initObj)(\n              val\n            )}\n          </FormItem>);\n      }\n\n    });\n\n    return (\n      <Modal\n        key={props.newKey}\n        visible={visible}\n        title={props.title}\n        width={props.width}\n        style={{height: \"90%\", overflow: \"hidden\", top: \"40px\"}}\n        okText=\"添加\"\n        onCancel={onCancel}\n        onOk={onCreate}\n      >\n        <Form>\n          { formItems }\n        </Form>\n      </Modal>\n    );\n  }\n);\n\n// 添加新数据模态框\nclass AddModel extends Component {\n  state = { \n    visible: false,\n    model: [],\n    modelName: [],\n    newKey: 1\n  }\n  componentDidMount(props) {\n    let dataValue = {};\n    let dataTpl = [];\n    let model = this.props.model;\n    let modelName = \"\";\n    let modelNameArr = [];\n\n    let projectUrl = this.props.url;\n\n    $.each(this.props.columns, function(i, v) {\n      if ( Config.jsonRequestType() === \"object\" ){\n        modelName = v.key; // 字段名为 key\n      }else{\n        modelName = model + \"[\"+ v.key +\"]\"; // 字段名修改为 model[key]\n      }\n      modelNameArr.push(modelName);        // 字段名添加到数组\n\n      dataValue[modelName] = \"\";\n      if (v.initialValue) {\n        dataValue[modelName] = v.initialValue;    // 设置字段默认值\n      }\n      dataValue[modelName] = GetColumnTpl(\n                            v.key,                // 字段名称\n                            modelName,            // 模型名称\n                            dataValue[modelName], // 默认值\n                            \"add\",                // 样式类型 [add, show, edit]\n                            projectUrl,           // 项目地址\n                            \"\",                   // 数据id\n                            undefined,            // updateList 回调函数\n                            undefined,            // 分类解释数据字段名\n                            v.isLocal             // 是否是本地解释数据\n                            );          \n      dataTpl.push(dataValue[modelName]);\n    });\n\n    this.setState({model: dataTpl});\n    this.setState({modelName: modelNameArr});\n  }\n\n  showModal = () => {\n    this.setState({\n      visible: true\n    });\n  }\n\n  handleCancel = () => this.setState({ \n    visible: false,\n    newKey: this.state.newKey===1?0:1\n  })\n\n  handleCreate = (e) => {\n    const form = this.form;\n    \n    form.validateFields((err, fieldsValue) => {\n      if (err) {\n        console.log(fieldsValue);\n        return;\n      }\n\n      if ( Config.jsonRequestType() === \"object\" ){\n        $.each(fieldsValue, function(k, v) {\n\n          let regExp = /(_){1}[^_]+$/;\n          let textIndex = k.search(regExp);\n          switch(textIndex>-1?k.slice(textIndex):0){\n            case \"_tag\":\n              $.each(fieldsValue[k], function(tagIndex, tagVal) {\n                tagIndex===0?fieldsValue[k] = tagVal:fieldsValue[k] += \",\"+tagVal;\n              });\n              break;\n            case \"_datetime\":\n              fieldsValue[k] = fieldsValue[k].format('YYYY-MM-DD HH:mm:ss');\n              break;\n            case \"_at\":\n              fieldsValue[k] = fieldsValue[k].format('YYYY-MM-DD HH:mm:ss');\n              break;\n            case \"_date\":\n              fieldsValue[k] = fieldsValue[k].format('YYYY-MM-DD');\n              break;\n            default:\n          }\n\n        });\n      }else{\n        $.each(fieldsValue, function(index, val) {\n           $.each(fieldsValue[index], function(k, v) {\n\n              let regExp = /(_){1}[^_]+$/;\n              let textIndex = k.search(regExp);\n              switch(textIndex>-1?k.slice(textIndex):0){\n                case \"_tag\":\n                  $.each(fieldsValue[index][k], function(tagIndex, tagVal) {\n                    tagIndex===0?fieldsValue[index][k] = tagVal:fieldsValue[index][k] += \",\"+tagVal;\n                  });\n                  break;\n                case \"_datetime\":\n                  if (fieldsValue[index][k]===null) {\n                    fieldsValue[index][k] = \"\";\n                  }else{\n                    fieldsValue[index][k] = fieldsValue[index][k].format('YYYY-MM-DD HH:mm:ss');\n                  }\n                  break;\n                case \"_at\":\n                  if (fieldsValue[index][k]===null) {\n                    fieldsValue[index][k] = \"\";\n                  }else{\n                    fieldsValue[index][k] = fieldsValue[index][k].format('YYYY-MM-DD HH:mm:ss');\n                  }\n                  break;\n                case \"_date\":\n                  if (fieldsValue[index][k]===null) {\n                    fieldsValue[index][k] = \"\";\n                  }else{\n                    fieldsValue[index][k] = fieldsValue[index][k].format('YYYY-MM-DD');\n                  }\n                  break;\n                default:\n              }\n\n           });\n        });\n      }\n\n      console.log('Received values of form: ', fieldsValue);\n\n      Global.LoadingStart();\n\n      const config = Global.getHeader();\n\n      const params = fieldsValue;\n\n      axios.post(this.props.url + this.props.modelUrl, params, config)\n        .then(response => {\n          if (response.headers[\"access-token\"]) {\n            Global.setTokenHeader(response);\n          }\n          console.log(response.headers);\n\n          Global.openNotification({type:\"success\", title:\"操作成功\", body:this.props.addTips});\n          this.props.updateList();\n          Global.LoadingEnd();\n\n        })\n        .catch(function (error) {\n          Global.openNotification({type:\"error\", title:\"操作失败\", body:\"请求超时，请刷新重试！\"});\n          console.log(error);\n          Global.getAuth(error);\n          Global.LoadingEnd();\n        });\n\n      form.resetFields();\n      this.setState({ \n        visible: false,\n        newKey: this.state.newKey + 1\n      });\n\n    });\n  }\n\n  saveFormRef = (form) => {\n    this.form = form;\n  }\n\n  render() {\n    return (\n      <div>\n        <Button className=\"add-button-top\" type=\"primary\" icon=\"plus\" onClick={this.showModal}>\n          添加\n        </Button>\n\n        <CollectionCreateForm\n          newKey={this.state.newKey}\n          ref={this.saveFormRef}\n          width={1200}\n          title={this.props.title}\n          columns={this.props.columns}\n          visible={this.state.visible}\n          onCancel={this.handleCancel}\n          onCreate={this.handleCreate}\n          formItemList={this.state.model}\n          formItemName={this.state.modelName}\n        />\n      </div>\n    );\n  }\n}\n\nexport default AddModel;"]}